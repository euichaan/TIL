# 쿼리 입문
## 1. 쿼리 역학
mysql 명령줄 도구를 사용한다면 이름과 비밀번호를 사용하여 MySQL 서버에 로그인한다.  
서버가 사용자 이름과 비밀번호가 맞는지 확인하면, 사용할 데이터베이스 연결(database connection)이 생성된다.  
이 연결은 응용 프로그램이 연결을 해제하거나 서버 셧다운 등으로 서버가 종료될 때까지 연결을 요청한 응용 프로그램에 의해 유지된다.  
  
MySQL 서버에 대한 각 연결에는 고유한 식별자가 할당되며 처음 로그인할 때 표시된다.  
```
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 18
```
  
쿼리가 서버로 전송될 때마다 서버는 구문을 실행하기 전에 다음 사항을 확인한다.  
- 이 구문을 실행할 권한(permission)이 있는가?  
- 원하는 데이터에 액세스 할 수 있는 권한이 있는가?  
- 구문의 문법이 정확한가?  
  
구문이 이 세 단계를 통과하면 쿼리는 쿼리 실행 시 가장 효율적인 방법을 결정하는 쿼리 옵티마이저로 전달된다.  
이 옵티마이저는 from 절에 명명된 테이블에 조인할 순서 및 사용 가능한 인덱스를 확인한 다음, 서버가 쿼리 실행에 필요한 실행 계획을 선택한다.  
  
## 2. 쿼리 절
select: 쿼리 결과에 포함할 열을 결정한다.  
from: 데이터를 검색할 테이블과, 테이블을 조인하는 방법을 식별한다.  
where: 불필요한 데이터를 걸러낸다.  
group by: 공통 열 값을 기준으로 행을 그룹화한다.  
having: 불필요한 그룹을 걸러낸다.  
order by: 하나 이상의 열을 기준으로 최종 결과의 행을 정렬한다.  
  
나열한 모든 절이 ANSI 사양에 포함된다.  
  
## 3. select 절 
select 절은 select 문의 첫 번째 절이지만 데이터베이스가 판단하는 마지막 절 중 하나이다.  
최종 결과셋에 포함할 항목을 결정하려면 최종 결과셋에 포함될 수 있는 모든 열을 먼저 알아야 하기 때문이다.  
  
**'모든 열 중에 쿼리 결과에 포함할 열을 결정하는 역할'**을 한다.  

다음과 같은 항목을 select 절에 추가할 수 있다.  
- 숫자 또는 문자열과 같은 리터럴  
- transaction.amount * -1 과 같은 표현식  
- ROUND(transaction.amount, 2)와 같은 내장 함수 호출  
- 사용자 정의 함수 호출  
  
```sql
SELECT language_id,
'COMMON' language_usage,  -- 문자열 'COMMON'을 반환하고 ,language_usage 라는 가상의 칼럼을 만든다.
language_id * 3.1415927 lang_pi_value,
upper(name) language_name
FROM language;
```
  
내장 함수만 실행하거나 간단한 표현식을 사용하는 경우에는 from절을 건너뛸 수 있다.  
```sql
SELECT version(),
user(),
database();
```
  
서버가 중복 데이터를 제거하는 것을 원치 않는다면 all을 지정할 수 있는데, 기본값이다.  
distinct 결과를 생성하려면 데이터를 정렬해야 하므로 결과셋의 용량이 클 때는 시간이 오래 걸릴 수 있다.  
중복이 없는지 확인하려고 distinct를 사용하는 함정에 빠지는 대신, 작업중인 데이터를 먼저 이해하고 중복 여부를 파악해야 한다.  
  
## 4. from 절 