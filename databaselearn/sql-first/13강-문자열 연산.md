# 13강 - 문자열 연산
`+ || CONCAT SUBSTRING TRIM CHARACTER_LENGTH`  
  
## 1. 문자열 결합
문자열 결합이란 다음과 같이 문자열 데이터를 결합하는 연산입니다.  
`'ABC' || '1234' -> 'ABC1234'`  
SQL Server는 문자열 결합에 + 연산자를 사용합니다.  
Oracle이나 DB2, PostgreSQL에서는 || 연산자를 사용해서 문자열을 결합합니다.  
MySQL에서는 CONCAT 함수로 문자열을 결합합니다.  
  
문자열 결합은 '2개의 열 데이터를 모아서 1개의 열로 처리하고 싶은'경우에 자주 사용합니다.  
`SELECT CONCAT(quantity, unit) FROM sample35;`  
unit 열은 문자열형이고 quantity 열은 INTEGER 형의 열입니다.  
문자열 결합이지만 수치 데이터도 문제없이 연산할 수 있습니다.  
  
## 2. SUBSTRING 함수
SUBSTRING 함수는 문자열의 일부분을 계산해서 반환해주는 함수입니다.  
데이터베이스에 따라서는 함수명이 SUBSTR인 경우도 있습니다.  
  
[앞 4자리(년) 추출]  
`SELECT SUBSTRING('20140125001', 1, 4);`  
  
[5째 자리부터 2자리(월) 추출]  
`SELECT SUBSTRING('20140125001', 5, 2);`  
  
## 3. TRIM 함수
TRIM 함수는 문자열의 앞뒤로 여분의 스페이스가 있을 경우 이를 제거해주는 함수로 문자열 도중에 존재하는 스페이스는 제거되지 않습니다.  
고정길이 문자열형에 대해 많이 사용하는 함수입니다.  
  
앞에서 설명했듯이 CHAR형의 문자열형에서는 문자열의 길이가 고정되며 남은 공간은 스페이스로 채워집니다.  
이처럼 빈 공간을 채우기 위해 사용한 스페이스를 제거하는 데 TRIM 함수를 사용할 수 있습니다.  
`SELECT TRIM('ABC     ');`  
  
한편, 인수를 지정하는 것으로 스페이스 이외의 문자를 제거할 수도 있습니다.  
`SELECT TRIM(BOTH 'a' FROM 'aabbccbbaa');`  
`SELECT TRIM(LEADING 'a' FROM 'aabbccbbaa');`  
`SELECT TRIM(TRAILING 'a' FROM 'aabbccbbaa');`  
  
## 4. CHARACTER_LENGTH 함수
CHARACTER_LENGTH 함수는 문자열의 길이를 계산해 돌려주는 함수입니다.  
VARCHAR형의 문자열은 가변 길이이므로 길이가 서로 다릅니다. CHARACTER_LENGTH 함수를 사용하면 문자열의 길이를 계산할 수 있습니다.  
함수명은 CHAR_LENGTH로 줄여서 사용할 수 있습니다. 한편 OCTET_LENGTH 함수는 문자열의 길이를 바이트 단위로 계산해 돌려주는 함수입니다.  
문자열의 길이는 문자 단위로 계산되어 `수치`로 반환됩니다.  
  
문자열 데이터도 결국 수치로 저장됩니다.  
  
SQL의 OCTET_LENGTH 함수를 잘 사용하는 동시에 중요한 것은 문자 하나의 데이터가 몇 바이트의 저장공간을 필요로 하는지 '인코드 방식'에 따라 결정된다는 점입니다.  
바꿔 말하자면 문자를 수치화(인코드)하는 방식에 따라 필요한 저장공간의 크기가 달라진다는 것입니다.  
  
VARCHAR 형의 최대 길이 역시 바이트 단위로 지정합니다.  
하지만 문자세트에 따라 길이가 문자 수로 간주되기도 하니 주의할 필요가 있습니다.  
  
알파벳의 경우 반각문자, 한글은 전각문자라고 할 수 있습니다.  
반각의 알파벳이나, 숫자, 기호는 ASCII 문자라고 불립니다.  
  
한글의 경우 'EUC-KR', "UTF-8'등의 인코드 방식을 주로 사용합니다. 인코드 방식은 데이터베이스나 테이블을 정의할 때 변경할 수 있습니다.  
이를 RDBMS에서는 '문자 세트'라고 부릅니다.  
핵심은 '한 문자가 몇 바이트인지는 쓰이는 문자세트 = 인코드 방식 에 따라 다르다' 라는 것입니다.  
  
EUC-KR에서 ASCII 문자는 1바이트, 한글은 2바이트의 용량을 가집니다.  
한편 UTF-8에서 ASCII 문자는 1바이트, 한글은 3바이트의 용량을 가집니다.  
이렇게 문자세트에 따라 한 문자의 크기는 달라집니다.  
문자열 조작 함수로 문자 단위가 아닌 바이트 단위로 지정할 경우에는 문자세트에 주의할 필요가 있습니다.  
  
MySQL에서 VARCHAR에 유효 최대 길이는 최대 행 크기(65,535 Byte) 및 사용된 문자셋에 따라 달라진다.  
예를 들어 UTF-8는 문자당 최대 3Byte를 요구할 수 있으므로 VARCHAR 컬럼은 최대 21,844 자로 선언될 수 있다.  
  
MySQL 4버전에서는 길이를 Byte 단위로 계산한다.  
MySQL 5버전에서는 길이를 문자(Character) 단위로 계산한다.  
  